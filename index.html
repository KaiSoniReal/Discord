<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Start Audio - Working Workaround</title>
    <style>
        /* Fullscreen overlay for fallback */
        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #000;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            z-index: 9999;
        }

        body, html {
            margin: 0;
            padding: 0;
        }

        /* Hide video primer */
        video {
            display: none;
        }

        /* Make audio visible for testing (remove 'display: block;' to hide) */
        audio {
            display: block; /* Change to 'none' to hide after testing */
            position: fixed;
            bottom: 10px;
            left: 10px;
            z-index: 10000;
        }
    </style>
</head>
<body>

<!-- Overlay for manual fallback -->
<div id="overlay">
    ▶️ Click, tap, move cursor, scroll, or press a key to start audio
</div>

<!-- Hidden silent video for autoplay priming -->
<video id="primerVideo" muted playsinline>
    <source src="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAAANtZGF0AAAA1m1vb3YAAABsbXZoZAAAAAAAAAAAAAAAAAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAOYaWF0YQAAAAAAAAACAAIAAAABAAAAAAEb2RhdGEAAAD4AAAAAQAAAAEAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" type="video/mp4">
</video>

<!-- Audio player with controls for testing -->
<audio id="mainAudio" controls>
    <source src="Jewelxxt%20luagh.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
</audio>

<script>
    const overlay = document.getElementById('overlay');
    const primerVideo = document.getElementById('primerVideo');
    const mainAudio = document.getElementById('mainAudio');

    // Log audio errors for debugging
    mainAudio.addEventListener('error', (err) => {
        console.error('Audio error:', mainAudio.error.message, mainAudio.error.code);
        // Common codes: 1 = Aborted, 2 = Network error (e.g., file not found), 3 = Decoding error, 4 = Unsupported format
    });

    // Function to play main audio
    function playMainAudio() {
        mainAudio.play().then(() => {
            overlay.style.display = 'none';
            console.log('Main audio playing successfully');
        }).catch(err => {
            console.error('Main audio playback failed:', err.message);
            overlay.textContent = '⚠️ Audio blocked or failed. Check console for errors and try again.';
        });
    }

    // Function to try autoplay with retries
    function tryAutoplay(attempts = 0, maxAttempts = 5) {
        console.log(`Autoplay attempt ${attempts + 1}`);
        primerVideo.play().then(() => {
            console.log('Primer video played successfully');
            primerVideo.pause();
            playMainAudio();
        }).catch(err => {
            console.error('Primer video failed:', err.message);
            if (attempts < maxAttempts) {
                setTimeout(() => tryAutoplay(attempts + 1, maxAttempts), 500);
            } else {
                console.log('All autoplay attempts failed - waiting for user interaction');
            }
        });
    }

    // Trigger autoplay on load
    window.addEventListener('load', () => {
        console.log('Page loaded, attempting autoplay');
        tryAutoplay();
    });

    document.addEventListener('DOMContentLoaded', () => {
        console.log('DOM content loaded, attempting autoplay');
        tryAutoplay();
    });

    // Fallback: Trigger on any user interaction
    const tryManualPlay = () => {
        console.log('Manual interaction detected, attempting to play');
        playMainAudio();
    };

    // Add multiple gesture listeners (run only once per type)
    ['click', 'pointerdown', 'pointermove', 'touchstart', 'scroll', 'keydown'].forEach(eventType => {
        document.addEventListener(eventType, tryManualPlay, { once: true });
        console.log(`Added listener for ${eventType}`);
    });
</script>

</body>
</html>
